(()=>{let e=new mm.SoundFontPlayer("https://storage.googleapis.com/magentadata/js/soundfonts/sgm_plus");document.querySelector(".playpause-btn").addEventListener("click",(function(){document.getElementById("error"),e.isPlaying()?e.stop():function(t){const o=mm.sequences.mergeConsecutiveNotes(t);e.setTempo(100),e.start(o)}(t.getNoteSequence())})),document.querySelector(".infill-btn").addEventListener("click",(function(){const e=t.data,o=[0,3,4,7,8,9];let n=[];for(let o=0;o<t.grid_width;o++){const l=Array(t.grid_height).fill(0).map(((e,t)=>e+t)).filter((t=>1===e[t][o].on));n.push(l.map((e=>MAX_PITCH-e)))}console.log("pitches per time:"),console.log(n);let s=Array(t.grid_height).fill(MAX_PITCH).map(((e,t)=>e-t));console.log("all pitches:"),console.log(s);let i=[];for(let e=0;e<t.grid_width;e++){let t=n[e];if(0===t.length){let e=l(s);i.push(e)}else{let e=l(t),n=l(s.filter((t=>o.includes(Math.abs(t-e)%12))));i.push(n)}}console.log("infilled pitches:"),console.log(i);for(let e of i.entries())t.toggleCell(MAX_PITCH-e[1],e[0],2);return i}));const t=new ButtonGrid,o=[];for(let e=0;e<t.grid_height;e++)o.push({pitch:MAX_PITCH-e,velocity:80});function l(e){var t;return e[(0,t=e.length-1,Math.floor(Math.random()*(t-0+1))+0)]}e.loadSamples({notes:o}),document.getElementById("container").addEventListener("click",(function(o){let l=o.target;if("BUTTON"===l.tagName){const o=parseInt(l.dataset.row),n=parseInt(l.dataset.col),s=parseInt(l.dataset.pitch);if(t.toggleCell(o,n,1),1===t.data[o][n].on){const t={pitch:s,velocity:80};e.playNoteDown(t),setTimeout((()=>e.playNoteUp(t)),150)}}}))})();